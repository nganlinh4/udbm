<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Loading uDBM...</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        html, body {
            background: transparent !important; /* no background */
            -webkit-font-smoothing: antialiased;
            -webkit-text-size-adjust: 100%;
        }
        body {
            display: flex; justify-content: center; align-items: center;
            height: 100vh; overflow: hidden; user-select: none;
        }
        .splash-container { display: flex; justify-content: center; align-items: center; width: 100%; height: 100%; background: transparent !important; }
        .svg-container { position: relative; width: 400px; height: 400px; display: flex; justify-content: center; align-items: center; background: transparent !important; }
        #splash-svg { width: 100%; height: 100%; background: none !important; }
        /* Ensure per-path transforms use their own boxes */
        #splash-svg path { transform-box: fill-box; transform-origin: center; will-change: transform; }
        /* Respect reduced motion */
        @media (prefers-reduced-motion: reduce) {
            #splash-svg path { animation: none !important; transition: none !important; }
        }
    </style>
</head>
<body>
    <div class="splash-container">
        <div class="svg-container"><!-- SVG will be loaded here --></div>
    </div>

    <script>
        // Load and animate SVG
        async function loadSVG() {
            try {
                const response = await fetch('./splash.svg');
                const svgText = await response.text();
                const parser = new DOMParser();
                const svgDoc = parser.parseFromString(svgText, 'image/svg+xml');
                const svgElement = svgDoc.querySelector('svg');
                if (svgElement) {
                    svgElement.id = 'splash-svg';
                    document.querySelector('.svg-container').appendChild(svgElement);
                    animatePaths();
                }
            } catch (error) {
                console.error('Error loading SVG:', error);
                createFallbackLogo();
            }
        }

        function animatePaths() {
            const svg = document.getElementById('splash-svg');
            if (!svg) return;
            const paths = Array.from(svg.querySelectorAll('path'));

            // All paths scale from small to large together (loading-like progress)
            const durationMs = 2500; // total time for the grow animation
            const minScale = 0.15;   // starting scale (15%)

            // Easing: easeOutCubic
            const easeOutCubic = (x) => 1 - Math.pow(1 - x, 3);

            // Disable any CSS animations â€” JS fully controls transforms here
            paths.forEach((p) => (p.style.animation = 'none'));

            const t0 = performance.now();
            function tick(now) {
                const raw = Math.min(1, Math.max(0, (now - t0) / durationMs));
                const e = easeOutCubic(raw);
                const s = (minScale + (1 - minScale) * e).toFixed(4);

                for (let i = 0; i < paths.length; i++) {
                    const path = paths[i];
                    path.style.transform = `scale(${s})`;
                }

                if (raw < 1) {
                    requestAnimationFrame(tick);
                } else {
                    // Ensure final state is exact 1.0
                    for (const path of paths) path.style.transform = 'scale(1)';
                }
            }
            requestAnimationFrame(tick);
        }

        function createFallbackLogo() {
            const container = document.querySelector('.svg-container');
            container.innerHTML = `
                <div style="font-size:72px;font-weight:bold;color:#fff;animation:levitate 4s ease-in-out infinite;">uDBM</div>
            `;
        }

        document.addEventListener('DOMContentLoaded', loadSVG);
    </script>
</body>
</html>
